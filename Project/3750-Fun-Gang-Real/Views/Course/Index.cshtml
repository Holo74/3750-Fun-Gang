@model Assignment_1.Models.StudentAssignmentListViewModel

@{
	ViewData["Title"] = "Course";
}

<div class="text-center">
	<h1>@Model.Class.CourseName</h1>
</div>
@if (Model.User.UserType != "Student")
{
	<div class="class">
		<a asp-action="Create" asp-route-classId="@Model.Class.ClassId">Create New Assignment</a>
		@*  <a href="@Url.Action("Index", "ClassAssignments",  { classID = item.ClassId })">*@
	</div>
}

@{
	double totalgrade = 0;
	double totalmaxgrade = 0;
	double totalpercent = 0;
}
@foreach (var item in Model.Assignments)
{
	@if (Model.User.UserType == "Student")
	{
		@if (item.Submission.Count() == 1)
		{
			@if (item.Submission.FirstOrDefault().Points != null){
				
				totalgrade = totalgrade+(double)item.Submission.FirstOrDefault().Points;
				totalmaxgrade = totalmaxgrade + (double)item.Assignment.MaxPoints;
			}
		}
	}
}
@{
	totalpercent = (totalgrade/totalmaxgrade)*100;
	string lettergrade;
	@if(totalpercent >= 94)
	{
		lettergrade = "A";
	}else if(totalpercent >= 90)
	{
		lettergrade = "A-";
	}
	else if (totalpercent >= 87)
	{
		lettergrade = "B+";
	}
	else if (totalpercent >= 84)
	{
		lettergrade = "B";
	}
	else if (totalpercent >= 80)
	{
		lettergrade = "B-";
	}
	else if (totalpercent >= 77)
	{
		lettergrade = "C+";
	}
	else if (totalpercent >= 74)
	{
		lettergrade = "C";
	}
	else if (totalpercent >= 70)
	{
		lettergrade = "C-";
	}
	else if (totalpercent >= 67)
	{
		lettergrade = "D+";
	}
	else if (totalpercent >= 64)
	{
		lettergrade = "D";
	}
	else if (totalpercent >= 60)
	{
		lettergrade = "D-";
	}
	else
	{
		lettergrade = "E";
	}


    <h3> 
        Letter grade: @lettergrade (@Math.Round(@totalpercent, 2)%)
    </h3>
}

<table class="table">
	<thead>
		<tr>
			<th>
				Assignment title
			</th>

			<th>
				Due Date
			</th>

			<th>
				Due Time
			</th>
			<th>
				Points
			</th>
		</tr>
	</thead>
	@* <th>
	<tr>
	<td>
	Name
	</td>
	<td>
	Day Due
	</td>
	<td>
	Time Due
	</td>
	</tr>
	*@
	<tbody>
		@foreach (var item in Model.Assignments)
		{
			<tr>
				<td>
					@Html.DisplayFor(modelData => item.Assignment.AssignmentTitle)
				</td>
				<td>
					@Html.DisplayFor(modelData => item.Assignment.DueDate)
				</td>
				<td>
					@Html.DisplayFor(modelData => item.Assignment.DueTime)
                </td>
				@if (Model.User.UserType == "Student")
				{
					<td>
						@Html.DisplayFor(modelData => item.Submission.FirstOrDefault().Points) / @Html.DisplayFor(modelData => item.Assignment.MaxPoints)
                </td>
				}


				@*until the below comparison to see if teacher or student works, just show all the buttons*@
				@if (Model.User.UserType != "Student")
				{
					<td>
						@Html.DisplayFor(modelData => item.Assignment.MaxPoints)
					</td>
					<td>

						<a asp-action="Edit" asp-route-id="@item.Assignment.Id">Edit</a>
						
					</td>
					<td>
						<button class="btn btn-primary">
							<a asp-action="Details" asp-route-id="@item.Assignment.Id">Details</a>
						</button>
					</td>
					<td>
						<a class="btn btn-primary" href="ClassAssignments/Submissions/?ID=@item.Assignment.Id">Submissions</a>
					</td>
				}
				else
				{
					<td>
						<a class="btn btn-primary" href="ClassAssignments/Assignment/?ID=@item.Assignment.Id">Submit</a>
					</td>
				}
				@*
				@if (Model.User.UserType != "Student")
				{
					<td>
						<button class="btn btn-primary">
							Edit
						</button>
					</td>
					<td>
						<button class="btn btn-primary">
							Delete
						</button>
					</td>
					<td>
						<button class="btn btn-primary">
							Submissions
						</button>
					</td>
				}
				else
				{
					<td>
						<a class="btn btn-primary" href="ClassAssignments/Assignment/?ID=@item.Id">Submit</a>
					</td>

				}*@
			</tr>
		}
		
	</tbody>
</table>